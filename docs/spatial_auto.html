

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5 Spatial Autocorrelation &mdash; pygeoda 0.0.4 rc documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6 Spatial Clustering" href="spatial_clustering.html" />
    <link rel="prev" title="4 Spatial Weights" href="spatial_weights.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #343131" >
          

          
            <a href="index.html" class="icon icon-home"> pygeoda
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">USER GUIDE</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#live-tutorials">1.1  Live Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#open-resources">1.2 Open Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="install.html">2. Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html#mac">2.1 Mac</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#windows">2.2 Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#linux">2.3 Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#import-pygeoda">2.4 Import pygeoda</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="load_data.html">3. Load Spatial Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="load_data.html#attributes-of-geoda-object">3.1 Attributes of geoda object</a></li>
<li class="toctree-l2"><a class="reference internal" href="load_data.html#access-table-data">3.1 Access Table Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="spatial_weights.html">4. Spatial Weights</a><ul>
<li class="toctree-l2"><a class="reference internal" href="spatial_weights.html#queen-contiguity-weights">4.1 Queen Contiguity Weights</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial_weights.html#attributes-of-weight-object">4.2 Attributes of <cite>Weight</cite> object</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial_weights.html#rook-contiguity-weights">4.3 Rook Contiguity Weights</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial_weights.html#distance-based-weights">4.4 Distance Based Weights</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial_weights.html#k-nearest-neighbor-weights">4.5 K-Nearest Neighbor Weights</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial_weights.html#kernel-weights">4.6 Kernel Weights</a><ul>
<li class="toctree-l3"><a class="reference internal" href="spatial_weights.html#kernel-weights-with-fixed-bandwidth">4.6.1 Kernel Weights with fixed bandwidth</a></li>
<li class="toctree-l3"><a class="reference internal" href="spatial_weights.html#kernel-weights-with-adaptive-bandwidth">4.6.2 Kernel Weights with adaptive bandwidth</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">5. Spatial Autocorrelation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#local-moran">5.1 Local Moran</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lisa-object">5.2 LISA object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#local-geary">5.3 Local Geary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#local-getis-ord-statistics">5.4 Local Getis-Ord Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#local-join-count">5.5 Local Join Count</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quantile-lisa">5.6 Quantile LISA</a></li>
<li class="toctree-l2"><a class="reference internal" href="#batch-local-moran">5.7 Batch Local Moran</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="spatial_clustering.html">6. Spatial Clustering</a><ul>
<li class="toctree-l2"><a class="reference internal" href="spatial_clustering.html#skater">6.1 SKATER</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial_clustering.html#redcap">6.2 REDCAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial_clustering.html#max-p">6.3 Max-p</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="esda_geopandas.html">7. ESDA with pygeoda and geopandas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="esda_geopandas.html#geopandas">7.1 GeoPandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="esda_geopandas.html#matplotlib">7.2 Matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="esda_geopandas.html#geopandas-pygeoda">7.2 geoPandas + pygeoda</a><ul>
<li class="toctree-l3"><a class="reference internal" href="esda_geopandas.html#load-geospatial-data-in-geopandas">7.2.1 Load geospatial data in GeoPandas</a></li>
<li class="toctree-l3"><a class="reference internal" href="esda_geopandas.html#create-pygeoda-object-from-geodataframe">7.2.2 Create pygeoda object from geodataframe</a></li>
<li class="toctree-l3"><a class="reference internal" href="esda_geopandas.html#id1">7.2.3 ESDA with pygeoda and geopandas</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="map_classification.html">8. Map Classification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="map_classification.html#hinge-box-breaks">8.1 Hinge Box Breaks</a></li>
<li class="toctree-l2"><a class="reference internal" href="map_classification.html#natural-breaks">8.2 Natural Breaks</a></li>
<li class="toctree-l2"><a class="reference internal" href="map_classification.html#quantile-breaks">8.3 Quantile Breaks</a></li>
<li class="toctree-l2"><a class="reference internal" href="map_classification.html#percentile-breaks">8.4 Percentile Breaks</a></li>
<li class="toctree-l2"><a class="reference internal" href="map_classification.html#standard-deviation-breaks">8.5 Standard Deviation Breaks</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API REFERENCE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">pygeoda API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#pygeoda-i-o">pygeoda (I/O)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.open.html">pygeoda.open</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.geopandas_to_geoda.html">pygeoda.geopandas_to_geoda</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.geoda_to_geopandas.html">pygeoda.geoda_to_geopandas</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.geoda.html">pygeoda.geoda</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#pygeoda-weights">pygeoda.weights</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.weights.Weight.html">pygeoda.weights.Weight</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.weights.queen.html">pygeoda.weights.queen</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.weights.rook.html">pygeoda.weights.rook</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.weights.distance.html">pygeoda.weights.distance</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.weights.knn.html">pygeoda.weights.knn</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.weights.kernel.html">pygeoda.weights.kernel</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#pygeoda-spatial-autocorrelation">pygeoda (spatial autocorrelation)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.lisa.html">pygeoda.lisa</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.batchlisa.html">pygeoda.batchlisa</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.local_moran.html">pygeoda.local_moran</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.batch_local_moran.html">pygeoda.batch_local_moran</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.local_geary.html">pygeoda.local_geary</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.local_multigeary.html">pygeoda.local_multigeary</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.local_joincount.html">pygeoda.local_joincount</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.local_multijoincount.html">pygeoda.local_multijoincount</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.local_g.html">pygeoda.local_g</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.local_gstar.html">pygeoda.local_gstar</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.quantile_lisa.html">pygeoda.quantile_lisa</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#pygeoda-spatial-clustering">pygeoda (spatial clustering)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.skater.html">pygeoda.skater</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.redcap.html">pygeoda.redcap</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.maxp.html">pygeoda.maxp</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.between_sumofsquare.html">pygeoda.between_sumofsquare</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.total_sumofsquare.html">pygeoda.total_sumofsquare</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.within_sumofsquare.html">pygeoda.within_sumofsquare</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#pygeoda-classify">pygeoda (classify)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.hinge15_breaks.html">pygeoda.hinge15_breaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.hinge30_breaks.html">pygeoda.hinge30_breaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.natural_breaks.html">pygeoda.natural_breaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.quantile_breaks.html">pygeoda.quantile_breaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.percentile_breaks.html">pygeoda.percentile_breaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.stddev_breaks.html">pygeoda.stddev_breaks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#pygeoda-data">pygeoda (data)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.mds.html">pygeoda.mds</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.PCA.html">pygeoda.PCA</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pygeoda</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>5 Spatial Autocorrelation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/spatial_auto.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="spatial-autocorrelation">
<span id="spatial-sa-ref"></span><h1>5 Spatial Autocorrelation<a class="headerlink" href="#spatial-autocorrelation" title="Permalink to this headline">¶</a></h1>
<p>pygeoda 0.0.4 provids following methods for univariate
local spatial autocorrelation statistics:</p>
<ul class="simple">
<li><p>Local Moran: local_moran()</p></li>
<li><p>Local Geary: local_geary()</p></li>
<li><p>Local Getis-Ord statistics: local_g() and local_gstar()</p></li>
<li><p>Local Join Count: local_joincount()</p></li>
</ul>
<p>Methods for bivariate and multivariate local spatial
autocorrelation statistics, as well as global spatial
autocorrelation satatistics, will be included in next
release of pygeoda.</p>
<p>In this tutorial, we will only introduce how to call these
methods using pygeoda. For more information about the local
spatial autocorrelation statisticis, please read the lab
note that Dr. Luc Anselin wrote:
<a class="reference external" href="http://geodacenter.github.io/workbook/6a_local_auto/lab6a.html">http://geodacenter.github.io/workbook/6a_local_auto/lab6a.html</a>.</p>
<div class="section" id="local-moran">
<h2>5.1 Local Moran<a class="headerlink" href="#local-moran" title="Permalink to this headline">¶</a></h2>
<p>The Local Moran statistic is a method to identify local clusters
and local spatial outliers. For example, we can call  function
<cite>local_moran()</cite> with the created Queen weights and the data
“crm_prp” as input parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lisa</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">local_moran</span><span class="p">(</span><span class="n">queen_w</span><span class="p">,</span> <span class="n">crm_prp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="lisa-object">
<h2>5.2 LISA object<a class="headerlink" href="#lisa-object" title="Permalink to this headline">¶</a></h2>
<p>The <cite>local_moran()</cite> function will return a <cite>lisa</cite> object,
which we can call its functions to access the results of lisa
computation. The functions include:</p>
<ul class="simple">
<li><p>GetClusterIndicators(): Get the local cluster indicators returned from LISA computation.</p></li>
<li><p>GetColors(): Get the cluster colors of LISA computation.</p></li>
<li><p>GetLabels(): Get the cluster labels of LISA computation.</p></li>
<li><p>GetLISAValues(): Get the local spatial autocorrelation values returned from LISA computation.</p></li>
<li><p>GetNumNeighbors(): Get the number of neighbors of every observations in LISA computation.</p></li>
<li><p>GetPValues(): Get the local pseudo-p values of significance returned from LISA computation.</p></li>
<li><p>GetFDR(): Get the False Discovery Rate (FDR) in LISA.</p></li>
<li><p>SetPermutations(num_perm): Set the number of permutations for the LISA computation</p></li>
<li><p>SetThreads(num_threads): Set the number of CPU threads for the LISA computation</p></li>
<li><p>Run(): Call to run LISA computation</p></li>
</ul>
<p>For example, we can call the function <cite>GetLISAValues()</cite>
to get the values of local Moran:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lms</span> <span class="o">=</span> <span class="n">lisa</span><span class="o">.</span><span class="n">GetLISAValues</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lms</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0.015431978309803657, 0.3270633223656033, 0.021295296214118884, 0.004610544790030418, -0.0028342407096540465, 0.41493771583040345, -0.13794630908086175, 0.09986576922564794, 0.2823176310018141, 0.1218745112146858, -0.09512054168698209, 0.032611193818022896, 0.3878324535340113, 1.1888723840162665, -0.6452792226077357, -0.30964927402750314, 0.3662775143008573, 2.0375343538940496, -0.005015479968822494, 0.06971105719113387)</span>
</pre></div>
</div>
<p>To get the pseudo-p values of significance of local Moran computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pvals</span> <span class="o">=</span> <span class="n">lisa</span><span class="o">.</span><span class="n">GetPValues</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pvals</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0.414, 0.123, 0.001, 0.474, 0.452, 0.087, 0.243, 0.326, 0.299, 0.303, 0.237, 0.46, 0.258, 0.018, 0.199, 0.188, 0.131, 0.004, 0.456, 0.342)</span>
</pre></div>
</div>
<p>To get the cluster indicators of local Moran computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cats</span> <span class="o">=</span> <span class="n">lisa</span><span class="o">.</span><span class="n">GetClusterIndicators</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cats</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
<span class="go">(0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0)</span>
</pre></div>
</div>
<p>The predefined values of the indicators of LISA cluster are:</p>
<ul class="simple">
<li><p>0 Not significant</p></li>
<li><p>1 High-High</p></li>
<li><p>2 Low-Low</p></li>
<li><p>3 High-Low</p></li>
<li><p>4 Low-High</p></li>
<li><p>5 Neighborless</p></li>
<li><p>6 Undefined</p></li>
</ul>
<p>which can be accessed via function <cite>GetLabels()</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lbls</span> <span class="o">=</span> <span class="n">lisa</span><span class="o">.</span><span class="n">GetLabels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lbls</span>
<span class="go">(&#39;Not significant&#39;,</span>
<span class="go">&#39;High-High&#39;,</span>
<span class="go">&#39;Low-Low&#39;,</span>
<span class="go">&#39;High-Low&#39;,</span>
<span class="go">&#39;Low-High&#39;,</span>
<span class="go">&#39;Undefined&#39;,</span>
<span class="go">&#39;Isolated&#39;)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Different LISA objects (e.g. local_geary()) will return different
labels and colors.</p>
</div>
<p>By default, the <cite>local_moran()</cite> function will run with
some default parameters, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">permutation</span> <span class="n">number</span><span class="p">:</span> <span class="mi">999</span>
<span class="n">seed</span> <span class="k">for</span> <span class="n">random</span> <span class="n">number</span> <span class="n">generator</span><span class="p">:</span> <span class="mi">123456789</span>
</pre></div>
</div>
<p>, which are identical to GeoDa desktop software so that
we can replicate the results in GeoDa software. It is also
easy to change the paremter and re-run the LISA computation
by calling Run() function.</p>
<p>For example, re-run the above local Moran example
using 9999 permutations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lisa</span><span class="o">.</span><span class="n">SetPermutations</span><span class="p">(</span><span class="mi">9999</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lisa</span><span class="o">.</span><span class="n">Run</span><span class="p">()</span>
</pre></div>
</div>
<p>Then, we can use the same <cite>lisa</cite> object to get the new results
after 9999 permutations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pvals</span> <span class="o">=</span> <span class="n">lisa</span><span class="o">.</span><span class="n">GetPValues</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pvals</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0.4187, 0.1265, 0.0004, 0.4679, 0.4545, 0.0728, 0.2312, 0.3071, 0.3115, 0.3088, 0.2187, 0.4803, 0.2623, 0.0113, 0.2, 0.1797, 0.1267, 0.0026, 0.4565, 0.3517)</span>
</pre></div>
</div>
<p>pygeoda uses GeoDa’s C++ code, in which multi-threading is used
to accelerate the computation of LISA. We can specify how many
threads to run the computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lisa</span><span class="o">.</span><span class="n">SetThreads</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lisa</span><span class="o">.</span><span class="n">Run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lisa</span><span class="o">.</span><span class="n">GetPValues</span><span class="p">()[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0.4187, 0.1265, 0.0004, 0.4679, 0.4545, 0.0728, 0.2312, 0.3071, 0.3115, 0.3088, 0.2187, 0.4834, 0.2686, 0.0102, 0.2024, 0.1795, 0.1218, 0.0025, 0.459, 0.3588)</span>
</pre></div>
</div>
</div>
<div class="section" id="local-geary">
<h2>5.3 Local Geary<a class="headerlink" href="#local-geary" title="Permalink to this headline">¶</a></h2>
<p>Local Geary is a type of LISA that focuses on squared
differences/dissimilarity. A small value of the local geary
statistics suggest positive spatial autocorrelation, whereas
large values suggest negative spatial autocorrelation.</p>
<p>For example, we can call the function <cite>local_geary()</cite> with the
created Queen weights and the data “crm_prp” as
input parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">geary_crmprp</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">local_geary</span><span class="p">(</span><span class="n">queen_w</span><span class="p">,</span> <span class="n">crm_prp</span><span class="p">)</span>
</pre></div>
</div>
<p>To get the cluster indicators of the local Geary computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cats</span> <span class="o">=</span> <span class="n">geary_crmprp</span><span class="o">.</span><span class="n">GetClusterIndicators</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cats</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0, 2, 4, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 2)</span>
</pre></div>
</div>
<p>To get the pseudo-p values of the local Geary computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">geary_crmprp</span><span class="o">.</span><span class="n">GetPValues</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pvals</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0.398, 0.027, 0.025, 0.126, 0.017, 0.314, 0.61, 0.141, 0.284, 0.11, 0.559, 0.462, 0.211, 0.236, 0.249, 0.229, 0.069, 0.041, 0.205, 0.02)</span>
</pre></div>
</div>
</div>
<div class="section" id="local-getis-ord-statistics">
<h2>5.4 Local Getis-Ord Statistics<a class="headerlink" href="#local-getis-ord-statistics" title="Permalink to this headline">¶</a></h2>
<p>There are two types of local Getis-Ord statistics: one is
computing a ratio of the weighted average of the values
in the neighboring locations, not including the value at
the location; while another type of statistic includes the
value at the location in both numerator and denominator.</p>
<p>A value larger than the mean suggests a high-high cluster
or hot spot, a value smaller than the mean indicates a
low-low cluster or cold spot.</p>
<p>For example, we can call the function <cite>local_g()</cite> with the
created Queen weights and the data “crm_prp” as
input parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">localg_crmprp</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">local_g</span><span class="p">(</span><span class="n">queen_w</span><span class="p">,</span> <span class="n">crm_prp</span><span class="p">)</span>
</pre></div>
</div>
<p>To get the cluster indicators of the local G computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cats</span> <span class="o">=</span> <span class="n">localg_crmprp</span><span class="o">.</span><span class="n">GetClusterIndicators</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cats</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0)</span>
</pre></div>
</div>
<p>To get the pseudo-p values of the local G computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pvals</span> <span class="o">=</span> <span class="n">localg_crmprp</span><span class="o">.</span><span class="n">GetPValues</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pvals</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0.414, 0.123, 0.001, 0.474, 0.452, 0.087, 0.243, 0.326, 0.299, 0.303, 0.237, 0.46, 0.258, 0.018, 0.199, 0.188, 0.131, 0.004, 0.456, 0.342)</span>
</pre></div>
</div>
<p>For the second type of local Getis-Ord statistics, we
can call the function <cite>local_gstar()</cite> with the created
Queen weights and the data “crm_prp” as input parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">localgstar_crmprp</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">local_gstar</span><span class="p">(</span><span class="n">queen_w</span><span class="p">,</span> <span class="n">crm_prp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="local-join-count">
<h2>5.5 Local Join Count<a class="headerlink" href="#local-join-count" title="Permalink to this headline">¶</a></h2>
<p>Local Join Count is a method to identify local clusters
for binary data by using a local version of the so-called
BB join count statistic. The statistic is only meaningful
for those observations with value 1.</p>
<p>For example, we can load the columbus dataset, and call
the function <cite>local_joincount()</cite> with a Queen weights and
the data “nsa”, which is a set of binary (0,1) values,
as input parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">columbus</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;./data/columbus.shp&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nsa</span> <span class="o">=</span> <span class="n">columbus</span><span class="o">.</span><span class="n">GetIntegerCol</span><span class="p">(</span><span class="s2">&quot;nsa&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">columbus_w</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">queen_weights</span><span class="p">(</span><span class="n">columbus</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">localjc_nsa</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">local_joincount</span><span class="p">(</span><span class="n">columbus_w</span><span class="p">,</span> <span class="n">nsa</span><span class="p">)</span>
</pre></div>
</div>
<p>To get the cluster indicators of the local Join Count computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cats</span> <span class="o">=</span> <span class="n">localjc_nsa</span><span class="o">.</span><span class="n">GetClusterIndicators</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cats</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0, 0, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 1, 0, 0)</span>
</pre></div>
</div>
<p>To get the pseudo-p values of the local Join Count  computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pvals</span> <span class="o">=</span> <span class="n">localjc_nsa</span><span class="o">.</span><span class="n">GetPValues</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pvals</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0.213, 0.07, 0.017, 0.024, 0.001, 0.226, 0.055, 0.007, 0.006, 0.275, 0.017, 0.008, 0.043, 0.004, 0.002, 0.001, 0.147, 0.049, 0.087, 0.001)</span>
</pre></div>
</div>
<p>To get the number of neighbors of the local Join Count computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nn</span> <span class="o">=</span> <span class="n">localjc_nsa</span><span class="o">.</span><span class="n">GetNumNeighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">nn</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(2, 3, 4, 4, 8, 2, 4, 6, 8, 4, 5, 6, 4, 6, 6, 8, 3, 4, 3, 10)</span>
</pre></div>
</div>
</div>
<div class="section" id="quantile-lisa">
<h2>5.6 Quantile LISA<a class="headerlink" href="#quantile-lisa" title="Permalink to this headline">¶</a></h2>
<p>The quantile local spatial autocorrelation converte the continuous variable
to a binary variable that takes the value of 1 for a specific quantile.
Then appaly a local join count to the data converted.Here a k and q need
to be selected. More specifically, the k is the number of quantiles,
ranging form 1 to -1, and the q is the index of selected quantile for lisa,
ranging from 0 to k-1.</p>
<p>For example, we can call the function <cite>quantile_lisa()</cite> with the created
Queen weights, k is equal to 7, q is equal to 5 and the data “crm_prp” as
input parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">columbus</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;./data/columbus.shp&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">crm_prp</span> <span class="o">=</span> <span class="n">columbus</span><span class="o">.</span><span class="n">GetIntegerCol</span><span class="p">(</span><span class="s2">&quot;crm_prp&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">columbus_w</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">queen_weights</span><span class="p">(</span><span class="n">columbus</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lisa</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">quantile_lisa</span><span class="p">(</span><span class="n">columbus_w</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">crm_prp</span><span class="p">)</span>
</pre></div>
</div>
<p>To get the pseudo-p values of the quantile lisa computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pvals</span> <span class="o">=</span> <span class="n">lisa</span><span class="o">.</span><span class="n">GetPValues</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pvals</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0.434, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.031, 0.001, 0.001, 0.431, 0.026, 0.001, 0.001)</span>
</pre></div>
</div>
<p>To get the number of neighbors of the quantile lisa computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nnvals</span> <span class="o">=</span> <span class="n">lisa</span><span class="o">.</span><span class="n">GetNumNeighbors</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">nnvals</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">    (4, 6, 6, 4, 3, 7, 3, 3, 5, 5, 7, 3, 3, 6, 5, 5, 6, 6, 7, 3)</span>
</pre></div>
</div>
</div>
<div class="section" id="batch-local-moran">
<h2>5.7 Batch Local Moran<a class="headerlink" href="#batch-local-moran" title="Permalink to this headline">¶</a></h2>
<p>Batch Local Moran is a method to apply local moran statistics on
a set of variables using a same weights. This is a convenient way
to batch process Lisa with the same weight. Note the data is a 2d
list of float type values of selected variables.</p>
<p>For example, we can call the function <cite>batch_local_moran()</cite> with the
created created Queen weights and the data was selected from the
dataset as the input parameters. When we have multiple variables,
we can create a list that contains the variables and then use a for
loop to select variables.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">guerry</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;./data/columbus.shp&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">guerry_w</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">queen_weights</span><span class="p">(</span><span class="n">guerry</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">slect_vars</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Crm_prp&#39;</span><span class="p">,</span><span class="s1">&#39;Crm_prs&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">guerry</span><span class="o">.</span><span class="n">GetRealCol</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">slect_vars</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Lisa</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">batch_local_moran</span><span class="p">(</span><span class="n">guerry_w</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>To get the local Moran values of one of the selected variables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lms</span> <span class="o">=</span> <span class="n">lisa</span><span class="o">.</span><span class="n">GetLISAValues</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lms</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0.015, 0.327, 0.021, 0.004, -0.002, 0.414, -0.137, 0.099, 0.282, 0.121, -0.095, 0.032, 0.387, 1.188, -0.645, -0.309, 0.366, 2.037, -0.005, 0.069)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lms</span> <span class="o">=</span> <span class="n">lisa</span><span class="o">.</span><span class="n">GetLISAValues</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lms</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0.516, 0.818, 0.794, 0.733, 0.228, 0.829, 0.615, 1.627, -0.019, 0.687, 1.707, 0.821, -0.213, 0.29, -0.184, -0.047, 0.249, 0.054, 0.862, 0.835)</span>
</pre></div>
</div>
<p>To get the pseudo-p values of the local moran computation of one selected variable:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pvals</span> <span class="o">=</span> <span class="n">lisa</span><span class="o">.</span><span class="n">GetPValues</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pvals</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0.414, 0.123, 0.001, 0.474, 0.452, 0.087, 0.243, 0.326, 0.299, 0.303, 0.237, 0.461, 0.248, 0.015, 0.178, 0.172, 0.149, 0.001, 0.456, 0.371)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pvals</span> <span class="o">=</span> <span class="n">lisa</span><span class="o">.</span><span class="n">GetPValues</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pvals</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0.197, 0.013, 0.023, 0.068, 0.111, 0.045, 0.281, 0.048, 0.183, 0.004, 0.002, 0.052, 0.106, 0.002, 0.266, 0.244, 0.008, 0.426, 0.060, 0.115)</span>
</pre></div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="spatial_clustering.html" class="btn btn-neutral float-right" title="6 Spatial Clustering" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="spatial_weights.html" class="btn btn-neutral float-left" title="4 Spatial Weights" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Xun Li; Luc Anselin. Developers: Xun Li; Hang Zhang; Yeqing Han.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>