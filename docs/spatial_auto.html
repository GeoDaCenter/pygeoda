

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>5 Local Indicators of Spatial Association–LISA &mdash; pygeoda 0.0.8 rc documentation</title>
  

  
  
  
  
    <link rel="canonical" href="https://geodacenter.github.io/pygeodaspatial_auto.html"/>
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="6 Spatial Clustering" href="spatial_clustering.html" />
    <link rel="prev" title="5 Spatial Weights" href="spatial_weights.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #343131" >
          

          
            <a href="index.html" class="icon icon-home"> pygeoda
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">USER GUIDE</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#open-resources">1.1 Open Resources</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="install.html">2. Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="install.html#windows">2.1 Windows</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#linux">2.2 Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#mac">2.3 Mac</a></li>
<li class="toctree-l2"><a class="reference internal" href="install.html#import-pygeoda">2.4 Import pygeoda</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="load_data.html">3. Load Spatial Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="load_data.html#attributes-of-geoda-object">3.1 Attributes of geoda object</a></li>
<li class="toctree-l2"><a class="reference internal" href="load_data.html#access-table-data">3.2 Access Table Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="map_classification.html">4. Map Classification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="map_classification.html#hinge-box-breaks">4.1 Hinge Box Breaks</a></li>
<li class="toctree-l2"><a class="reference internal" href="map_classification.html#natural-breaks">4.2 Natural Breaks</a></li>
<li class="toctree-l2"><a class="reference internal" href="map_classification.html#quantile-breaks">4.3 Quantile Breaks</a></li>
<li class="toctree-l2"><a class="reference internal" href="map_classification.html#percentile-breaks">4.4 Percentile Breaks</a></li>
<li class="toctree-l2"><a class="reference internal" href="map_classification.html#standard-deviation-breaks">4.5 Standard Deviation Breaks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="spatial_weights.html">5. Spatial Weights</a><ul>
<li class="toctree-l2"><a class="reference internal" href="spatial_weights.html#queen-contiguity-weights">5.1 Queen Contiguity Weights</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial_weights.html#attributes-of-weight-object">5.2 Attributes of <cite>Weight</cite> object</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial_weights.html#rook-contiguity-weights">5.3 Rook Contiguity Weights</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial_weights.html#distance-based-weights">5.4 Distance Based Weights</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial_weights.html#k-nearest-neighbor-weights">5.5 K-Nearest Neighbor Weights</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial_weights.html#kernel-weights">5.6 Kernel Weights</a><ul>
<li class="toctree-l3"><a class="reference internal" href="spatial_weights.html#kernel-weights-with-fixed-bandwidth">5.6.1 Kernel Weights with fixed bandwidth</a></li>
<li class="toctree-l3"><a class="reference internal" href="spatial_weights.html#kernel-weights-with-adaptive-bandwidth">5.6.2 Kernel Weights with adaptive bandwidth</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">6. Local Indicators of Spatial Association</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#local-moran">6.1 Local Moran</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lisa-object">6.2 LISA object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#local-geary">6.3 Local Geary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#local-getis-ord-statistics">6.4 Local Getis-Ord Statistics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#local-join-count">6.5 Local Join Count</a></li>
<li class="toctree-l2"><a class="reference internal" href="#local-bivariate-join-count">6.6 Local Bivariate Join Count</a></li>
<li class="toctree-l2"><a class="reference internal" href="#local-multivariate-join-count">6.7 Local Multivariate Join Count</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quantile-lisa">6.8 Quantile LISA</a></li>
<li class="toctree-l2"><a class="reference internal" href="#multivariate-quantile-lisa">6.9 Multivariate Quantile LISA</a></li>
<li class="toctree-l2"><a class="reference internal" href="#neighbor-match-test">6.10 Neighbor Match Test</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="spatial_clustering.html">7. Spatial Clustering</a><ul>
<li class="toctree-l2"><a class="reference internal" href="spatial_clustering.html#skater">7.1 SKATER</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial_clustering.html#redcap">7.2 REDCAP</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial_clustering.html#spatially-constrained-hierarchical-clucstering">7.3 Spatially Constrained Hierarchical Clucstering</a></li>
<li class="toctree-l2"><a class="reference internal" href="spatial_clustering.html#azp">7.3 AZP</a><ul>
<li class="toctree-l3"><a class="reference internal" href="spatial_clustering.html#azp-greedy">7.3.1 AZP greedy</a></li>
<li class="toctree-l3"><a class="reference internal" href="spatial_clustering.html#azp-simulated-annealing">7.3.2 AZP Simulated Annealing</a></li>
<li class="toctree-l3"><a class="reference internal" href="spatial_clustering.html#azp-tabu-search">7.3.3 AZP Tabu Search</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="spatial_clustering.html#max-p">7.4 Max-p</a><ul>
<li class="toctree-l3"><a class="reference internal" href="spatial_clustering.html#max-p-greedy">7.4.1 Max-p greedy</a></li>
<li class="toctree-l3"><a class="reference internal" href="spatial_clustering.html#max-p-tabu-search">7.4.2 Max-p Tabu Search</a></li>
<li class="toctree-l3"><a class="reference internal" href="spatial_clustering.html#max-p-simulated-annealing">7.4.3 Max-p Simulated Annealing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="esda_geopandas.html">ESDA with pygeoda and geopandas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="esda_geopandas.html#geopandas">1 GeoPandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="esda_geopandas.html#matplotlib">2 Matplotlib</a></li>
<li class="toctree-l2"><a class="reference internal" href="esda_geopandas.html#geopandas-pygeoda">3 GeoPandas + pygeoda</a><ul>
<li class="toctree-l3"><a class="reference internal" href="esda_geopandas.html#load-geospatial-data-in-geopandas">3.1 Load geospatial data in GeoPandas</a></li>
<li class="toctree-l3"><a class="reference internal" href="esda_geopandas.html#create-pygeoda-object-from-geodataframe">3.2 Create pygeoda object from geodataframe</a></li>
<li class="toctree-l3"><a class="reference internal" href="esda_geopandas.html#id1">3.3 ESDA with pygeoda and geopandas</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">API REFERENCE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="api.html">pygeoda API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#pygeoda-i-o">pygeoda (I/O)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.open.html">pygeoda.open</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.geoda.html">pygeoda.geoda</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#pygeoda-weights">pygeoda.weights</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.Weight.html">pygeoda.Weight</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.queen_weights.html">pygeoda.queen_weights</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.rook_weights.html">pygeoda.rook_weights</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.min_distthreshold.html">pygeoda.min_distthreshold</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.distance_weights.html">pygeoda.distance_weights</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.knn_weights.html">pygeoda.knn_weights</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.kernel_weights.html">pygeoda.kernel_weights</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.kernel_knn_weights.html">pygeoda.kernel_knn_weights</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#pygeoda-lisa">pygeoda (LISA)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.lisa.html">pygeoda.lisa</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.local_moran.html">pygeoda.local_moran</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.local_geary.html">pygeoda.local_geary</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.local_multigeary.html">pygeoda.local_multigeary</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.local_joincount.html">pygeoda.local_joincount</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.local_bijoincount.html">pygeoda.local_bijoincount</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.local_multijoincount.html">pygeoda.local_multijoincount</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.local_g.html">pygeoda.local_g</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.local_gstar.html">pygeoda.local_gstar</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.local_quantilelisa.html">pygeoda.local_quantilelisa</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.local_multiquantilelisa.html">pygeoda.local_multiquantilelisa</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.neighbor_match_test.html">pygeoda.neighbor_match_test</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.batchlisa.html">pygeoda.batchlisa</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.batch_local_moran.html">pygeoda.batch_local_moran</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#pygeoda-spatial-clustering">pygeoda (spatial clustering)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.skater.html">pygeoda.skater</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.redcap.html">pygeoda.redcap</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.schc.html">pygeoda.schc</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.azp_greedy.html">pygeoda.azp_greedy</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.azp_sa.html">pygeoda.azp_sa</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.azp_tabu.html">pygeoda.azp_tabu</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.maxp_greedy.html">pygeoda.maxp_greedy</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.maxp_sa.html">pygeoda.maxp_sa</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.maxp_tabu.html">pygeoda.maxp_tabu</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#pygeoda-classify">pygeoda (classify)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.hinge15_breaks.html">pygeoda.hinge15_breaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.hinge30_breaks.html">pygeoda.hinge30_breaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.natural_breaks.html">pygeoda.natural_breaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.quantile_breaks.html">pygeoda.quantile_breaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.percentile_breaks.html">pygeoda.percentile_breaks</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.stddev_breaks.html">pygeoda.stddev_breaks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api.html#pygeoda-data">pygeoda (data)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.demean.html">pygeoda.demean</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.standardize.html">pygeoda.standardize</a></li>
<li class="toctree-l3"><a class="reference internal" href="generated/pygeoda.mad.html">pygeoda.mad</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pygeoda</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>5 Local Indicators of Spatial Association–LISA</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/spatial_auto.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="local-indicators-of-spatial-associationlisa">
<span id="spatial-sa-ref"></span><h1>5 Local Indicators of Spatial Association–LISA<a class="headerlink" href="#local-indicators-of-spatial-associationlisa" title="Permalink to this headline">¶</a></h1>
<p>pygeoda provids following methods for univariate, bivariate and multivariate
local spatial autocorrelation statistics:</p>
<ul class="simple">
<li><p>Local Moran: local_moran(), local_moran_eb()</p></li>
<li><p>Local Geary: local_geary(), local_multigeary()</p></li>
<li><p>Local Getis-Ord statistics: local_g() and local_gstar()</p></li>
<li><p>Local Join Count: local_joincount(), local_bijoincount(), local_multijoincount()</p></li>
<li><p>Local Quantile LISA: local_quantilelisa(), local_multiquantilelisa()</p></li>
<li><p>Local Neighbor Match Test: neighbor_match_test()</p></li>
</ul>
<p>For more information about the local spatial autocorrelation statisticis,
please read Dr. Luc Anselin’s lab notes:
<a class="reference external" href="http://geodacenter.github.io/workbook/6a_local_auto/lab6a.html">http://geodacenter.github.io/workbook/6a_local_auto/lab6a.html</a>.</p>
<div class="section" id="local-moran">
<h2>6.1 Local Moran<a class="headerlink" href="#local-moran" title="Permalink to this headline">¶</a></h2>
<p>The Local Moran statistic is a method to identify local clusters
and local spatial outliers. For example, we can call  function
<cite>local_moran()</cite> with the created Queen weights and the data
“crm_prp = guerry[‘Crm_prp’]” as input parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lm</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">local_moran</span><span class="p">(</span><span class="n">queen_w</span><span class="p">,</span> <span class="n">crm_prp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lm</span>
<span class="go">lisa object:</span>
<span class="go">    lisa_values(): [0.015431978309803657, 0.3270633223656033, ...]</span>
<span class="go">    lisa_pvalues(): [0.414, 0.123, ...]</span>
<span class="go">    lisa_num_nbrs(): [4, 6, ...]</span>
<span class="go">    lisa_clusters(): [0, 0, ...]</span>
<span class="go">    lisa_labels(): (&#39;Not significant&#39;, &#39;High-High&#39;, &#39;Low-Low&#39;, &#39;High-Low&#39;, &#39;Low-High&#39;, &#39;Undefined&#39;, &#39;Isolated&#39;)</span>
<span class="go">    lisa_colors(): (&#39;#eeeeee&#39;, &#39;#FF0000&#39;, &#39;#0000FF&#39;, &#39;#a7adf9&#39;, &#39;#f4ada8&#39;, &#39;#464646&#39;, &#39;#999999&#39;)</span>
</pre></div>
</div>
</div>
<div class="section" id="lisa-object">
<h2>6.2 LISA object<a class="headerlink" href="#lisa-object" title="Permalink to this headline">¶</a></h2>
<p>The <cite>local_moran()</cite> function will return a <cite>lisa</cite> object,
which we can call its functions to access the results of lisa
computation. The functions include:</p>
<ul class="simple">
<li><p>lisa_clusters(): Get the local cluster indicators returned from LISA computation.</p></li>
<li><p>lisa_colors(): Get the cluster colors of LISA computation.</p></li>
<li><p>lisa_labels(): Get the cluster labels of LISA computation.</p></li>
<li><p>lisa_values(): Get the local spatial autocorrelation values returned from LISA computation.</p></li>
<li><p>lisa_num_nbrs(): Get the number of neighbors of every observations in LISA computation.</p></li>
<li><p>lisa_pvalues(): Get the local pseudo-p values of significance returned from LISA computation.</p></li>
<li><p>lisa_fdr(): Get the False Discovery Rate (FDR) in LISA.</p></li>
<li><p>lisa_bo(): Get the False Discovery Rate (FDR) in LISA.</p></li>
</ul>
<p>For example, we can call the function <cite>lisa_values()</cite>
to get the values of local Moran:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lms</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">lisa_values</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lms</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0.015431978309803657, 0.3270633223656033, 0.021295296214118884, 0.004610544790030418, -0.0028342407096540465, 0.41493771583040345, -0.13794630908086175, 0.09986576922564794, 0.2823176310018141, 0.1218745112146858, -0.09512054168698209, 0.032611193818022896, 0.3878324535340113, 1.1888723840162665, -0.6452792226077357, -0.30964927402750314, 0.3662775143008573, 2.0375343538940496, -0.005015479968822494, 0.06971105719113387)</span>
</pre></div>
</div>
<p>To get the pseudo-p values of significance of local Moran computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pvals</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">lisa_pvalues</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pvals</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0.414, 0.123, 0.001, 0.474, 0.452, 0.087, 0.243, 0.326, 0.299, 0.303, 0.237, 0.46, 0.258, 0.018, 0.199, 0.188, 0.131, 0.004, 0.456, 0.342)</span>
</pre></div>
</div>
<p>To get the cluster indicators of local Moran computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cats</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">lisa_clusters</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cats</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
<span class="go">(0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0)</span>
</pre></div>
</div>
<p>The predefined values of the indicators of LISA cluster are:</p>
<ul class="simple">
<li><p>0 Not significant</p></li>
<li><p>1 High-High</p></li>
<li><p>2 Low-Low</p></li>
<li><p>3 High-Low</p></li>
<li><p>4 Low-High</p></li>
<li><p>5 Neighborless</p></li>
<li><p>6 Undefined</p></li>
</ul>
<p>which can be accessed via function <cite>GetLabels()</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lbls</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">lisa_labels</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lbls</span>
<span class="go">(&#39;Not significant&#39;, &#39;High-High&#39;, &#39;Low-Low&#39;, &#39;High-Low&#39;, &#39;Low-High&#39;, &#39;Undefined&#39;, &#39;Isolated&#39;)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Different LISA objects (e.g. local_geary()) will return different
labels and colors.</p>
</div>
<p>By default, the <cite>local_moran()</cite> function will run with
some default parameters, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">significance_cutoff</span><span class="p">:</span> <span class="mf">0.05</span>
<span class="n">permutation</span><span class="p">:</span> <span class="mi">999</span>
<span class="n">permutation_method</span><span class="p">:</span> <span class="s1">&#39;complete&#39;</span>
<span class="n">cpu_threads</span><span class="p">:</span> <span class="mi">6</span>
<span class="n">seed</span> <span class="p">(</span><span class="k">for</span> <span class="n">random</span> <span class="n">number</span> <span class="n">generator</span><span class="p">):</span> <span class="mi">123456789</span>
</pre></div>
</div>
<p>, which are identical to GeoDa desktop software so to replicate the results
in GeoDa software.  You can set different values when calling the lisa functions.</p>
<p>For example, re-run the above local Moran example using 9999 permutations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lm</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">local_moran</span><span class="p">(</span><span class="n">queen_w</span><span class="p">,</span> <span class="n">crm_prp</span><span class="p">,</span> <span class="n">permutations</span><span class="o">=</span><span class="mi">9999</span><span class="p">)</span>
</pre></div>
</div>
<p>Then, we can use the same <cite>lisa</cite> object to get the new results
after 9999 permutations:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pvals</span> <span class="o">=</span> <span class="n">lm</span><span class="o">.</span><span class="n">lisa_pvalues</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pvals</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>
<span class="go">(0.4187, 0.1265, 0.0004, 0.4679, 0.4545, 0.0728, 0.2312, 0.3071, 0.3115, 0.3088, 0.2187, 0.4803, 0.2623, 0.0113, 0.2, 0.1797, 0.1267, 0.0026, 0.4565, 0.3517)</span>
</pre></div>
</div>
<p>pygeoda uses GeoDa’s C++ code, in which multi-threading is used
to accelerate the computation of LISA. We can specify how many
threads to run the computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lm</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">local_moran</span><span class="p">(</span><span class="n">queen_w</span><span class="p">,</span> <span class="n">crm_prp</span><span class="p">,</span> <span class="n">permutations</span><span class="o">=</span><span class="mi">9999</span><span class="p">,</span> <span class="n">cpu_threads</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lm</span><span class="o">.</span><span class="n">lisa_pvalues</span><span class="p">()[:</span><span class="mi">20</span><span class="p">]</span>
<span class="go">(0.4187, 0.1265, 0.0004, 0.4679, 0.4545, 0.0728, 0.2197, 0.3117, 0.3139, 0.3106, 0.2189, 0.4761, 0.2649, 0.0127, 0.2014, 0.1774, 0.1299, 0.0024, 0.4557, 0.3525)</span>
</pre></div>
</div>
</div>
<div class="section" id="local-geary">
<h2>6.3 Local Geary<a class="headerlink" href="#local-geary" title="Permalink to this headline">¶</a></h2>
<p>Local Geary is a type of LISA that focuses on squared
differences/dissimilarity. A small value of the local geary
statistics suggest positive spatial autocorrelation, whereas
large values suggest negative spatial autocorrelation.
For more details, please read: <a class="reference external" href="http://geodacenter.github.io/workbook/6b_local_adv/lab6b.html#local-geary">http://geodacenter.github.io/workbook/6b_local_adv/lab6b.html#local-geary</a></p>
<p>For example, we can call the function <cite>local_geary()</cite> with the
created Queen weights and the data “crm_prp” as
input parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">geary_crmprp</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">local_geary</span><span class="p">(</span><span class="n">queen_w</span><span class="p">,</span> <span class="n">crm_prp</span><span class="p">)</span>
<span class="go">lisa object:</span>
<span class="go">    lisa_values(): [7.39808330117836, 0.28361195650519017, 3.6988922226329906, 0.23250287024601668, 0.03509605454141339, 1.8488634321425461, 0.9456415438821265, 0.36881030678112625, 1.3990003912957896, 0.79132551685303, ...]</span>
<span class="go">    lisa_pvalues(): [0.398, 0.027, 0.025, 0.126, 0.017, 0.314, 0.61, 0.141, 0.284, 0.11, ...]</span>
<span class="go">    lisa_num_nbrs(): [4, 6, 6, 4, 3, 7, 3, 3, 5, 5, ...]</span>
<span class="go">    lisa_clusters(): [0, 2, 4, 0, 3, 0, 0, 0, 0, 0, ...]</span>
<span class="go">    lisa_labels(): (&#39;Not significant&#39;, &#39;High-High&#39;, &#39;Low-Low&#39;, &#39;Other Positive&#39;, &#39;Negative&#39;, &#39;Undefined&#39;, &#39;Isolated&#39;)</span>
<span class="go">    lisa_colors(): (&#39;#eeeeee&#39;, &#39;#b2182b&#39;, &#39;#ef8a62&#39;, &#39;#fddbc7&#39;, &#39;#67adc7&#39;, &#39;#464646&#39;, &#39;#999999&#39;)</span>
</pre></div>
</div>
<p>To get the cluster indicators of the local Geary computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cats</span> <span class="o">=</span> <span class="n">geary_crmprp</span><span class="o">.</span><span class="n">lisa_clusters</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cats</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0, 2, 4, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 2)</span>
</pre></div>
</div>
<p>To get the pseudo-p values of the local Geary computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">geary_crmprp</span><span class="o">.</span><span class="n">lisa_pvalues</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pvals</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0.398, 0.027, 0.025, 0.126, 0.017, 0.314, 0.61, 0.141, 0.284, 0.11, 0.559, 0.462, 0.211, 0.236, 0.249, 0.229, 0.069, 0.041, 0.205, 0.02)</span>
</pre></div>
</div>
</div>
<div class="section" id="local-getis-ord-statistics">
<h2>6.4 Local Getis-Ord Statistics<a class="headerlink" href="#local-getis-ord-statistics" title="Permalink to this headline">¶</a></h2>
<p>There are two types of local Getis-Ord statistics: one is
computing a ratio of the weighted average of the values
in the neighboring locations, not including the value at
the location; while another type of statistic includes the
value at the location in both numerator and denominator.
For more details, please read: <a class="reference external" href="http://geodacenter.github.io/workbook/6b_local_adv/lab6b.html#getis-ord-statistics">http://geodacenter.github.io/workbook/6b_local_adv/lab6b.html#getis-ord-statistics</a></p>
<p>A value larger than the mean suggests a high-high cluster
or hot spot, a value smaller than the mean indicates a
low-low cluster or cold spot.</p>
<p>For example, we can call the function <cite>local_g()</cite> with the
created Queen weights and the data “crm_prp” as
input parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">localg_crmprp</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">local_g</span><span class="p">(</span><span class="n">queen_w</span><span class="p">,</span> <span class="n">crm_prp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">localg_crmprp</span>
<span class="go">lisa object:</span>
<span class="go">    lisa_values(): [0.012077920687925825, 0.009924096129850856, 0.018753584525825453, 0.01178494623655914, 0.011774009933407884, 0.014402421020466018, 0.009913770717138606, 0.012754984853234634, 0.01079858461945127, 0.012624434594978189, ...] lisa_pvalues(): [0.414, 0.123, 0.001, 0.474, 0.452, 0.087, 0.243, 0.326, 0.299, 0.303, ...]</span>
<span class="go">    lisa_num_nbrs(): [4, 6, 6, 4, 3, 7, 3, 3, 5, 5, ...]</span>
<span class="go">    lisa_clusters(): [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, ...]</span>
<span class="go">    lisa_labels(): (&#39;Not significant&#39;, &#39;High-High&#39;, &#39;Low-Low&#39;, &#39;Undefined&#39;, &#39;Isolated&#39;)</span>
<span class="go">    lisa_colors(): (&#39;#eeeeee&#39;, &#39;#FF0000&#39;, &#39;#0000FF&#39;, &#39;#464646&#39;, &#39;#999999&#39;)</span>
</pre></div>
</div>
<p>To get the cluster indicators of the local G computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cats</span> <span class="o">=</span> <span class="n">localg_crmprp</span><span class="o">.</span><span class="n">lisa_clusters</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">cats</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0)</span>
</pre></div>
</div>
<p>To get the pseudo-p values of the local G computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">pvals</span> <span class="o">=</span> <span class="n">localg_crmprp</span><span class="o">.</span><span class="n">lisa_pvalues</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">pvals</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(0.414, 0.123, 0.001, 0.474, 0.452, 0.087, 0.243, 0.326, 0.299, 0.303, 0.237, 0.46, 0.258, 0.018, 0.199, 0.188, 0.131, 0.004, 0.456, 0.342)</span>
</pre></div>
</div>
<p>For the second type of local Getis-Ord statistics, we
can call the function <cite>local_gstar()</cite> with the created
Queen weights and the data “crm_prp” as input parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">localgstar_crmprp</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">local_gstar</span><span class="p">(</span><span class="n">queen_w</span><span class="p">,</span> <span class="n">crm_prp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">localgstar_crmprp</span>
<span class="go">lisa object:</span>
<span class="go">    lisa_values(): [0.014177043620524426, 0.0096136007223102, 0.017574324039034434, 0.01150147630889935, 0.011773152971874002, 0.014324040100669639, 0.010638678994617219, 0.01301062524443436, 0.009960482489792222, 0.012951662452195357, ...]</span>
<span class="go">    lisa_pvalues(): [0.414, 0.123, 0.001, 0.474, 0.452, 0.087, 0.243, 0.326, 0.299, 0.303, ...]</span>
<span class="go">    lisa_num_nbrs(): [4, 6, 6, 4, 3, 7, 3, 3, 5, 5, ...]</span>
<span class="go">    lisa_clusters(): [0, 0, 1, 0, 0, 0, 0, 0, 0, 0, ...]</span>
<span class="go">    lisa_labels(): (&#39;Not significant&#39;, &#39;High-High&#39;, &#39;Low-Low&#39;, &#39;Undefined&#39;, &#39;Isolated&#39;)</span>
<span class="go">    lisa_colors(): (&#39;#eeeeee&#39;, &#39;#FF0000&#39;, &#39;#0000FF&#39;, &#39;#464646&#39;, &#39;#999999&#39;)</span>
</pre></div>
</div>
</div>
<div class="section" id="local-join-count">
<h2>6.5 Local Join Count<a class="headerlink" href="#local-join-count" title="Permalink to this headline">¶</a></h2>
<p>Local Join Count is a method to identify local clusters
for binary data by using a local version of the so-called
BB join count statistic. The statistic is only meaningful
for those observations with value 1. For more details, please read
<a class="reference external" href="http://geodacenter.github.io/workbook/6d_local_discrete/lab6d.html">http://geodacenter.github.io/workbook/6d_local_discrete/lab6d.html</a></p>
<p>For example, we can create a binary data manually by using the quantile
breaks and the variable <cite>Crm_prp</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">top_crmprp</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mf">9584.5</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">guerry</span><span class="p">[</span><span class="s1">&#39;Crm_prp&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top_crmprp</span>
<span class="go">[1, 0, 0, 0, 0, 1, ...]</span>
</pre></div>
</div>
<p>If you are using geopandas, you can create such a variable using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">gdf</span> <span class="o">=</span> <span class="n">geopandas</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;./data/Guerry.shp&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top_crmprp</span> <span class="o">=</span> <span class="n">gdf</span><span class="p">[</span><span class="s1">&#39;Crm_prp&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">9584.5</span>
</pre></div>
</div>
<p>Then, we can apply the function <cite>local_joincount()</cite> using a Queen weights and
the data “top_crmprp”:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ljc_topcrmprp</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">local_joincount</span><span class="p">(</span><span class="n">queen_w</span><span class="p">,</span> <span class="n">top_crmprp</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ljc_topcrmprp</span>
<span class="go">lisa object:</span>
<span class="go">    lisa_values(): [1.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 2.0, ...]</span>
<span class="go">    lisa_pvalues(): [0.419, nan, nan, nan, nan, 0.376, nan, 0.442, nan, 0.257, ...]</span>
<span class="go">    lisa_num_nbrs(): [4, 6, 6, 4, 3, 7, 3, 3, 5, 5, ...]</span>
<span class="go">    lisa_clusters(): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...]</span>
<span class="go">    lisa_labels(): (&#39;Not significant&#39;, &#39;Significant&#39;, &#39;Undefined&#39;, &#39;Isolated&#39;)</span>
<span class="go">    lisa_colors(): (&#39;#eeeeee&#39;, &#39;#348124&#39;, &#39;#464646&#39;, &#39;#999999&#39;)</span>
</pre></div>
</div>
<p>To get the number of neighbors of the local Join Count computation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nn</span> <span class="o">=</span> <span class="n">ljc_topcrmprp</span><span class="o">.</span><span class="n">lisa_num_nbrs</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">nn</span><span class="p">[:</span><span class="mi">20</span><span class="p">])</span>
<span class="go">(4, 6, 6, 4, 3, 7, 3, 3, 5, 5, 7, 3, 3, 6, 5, 5, 6, 6, 7, 3)</span>
</pre></div>
</div>
</div>
<div class="section" id="local-bivariate-join-count">
<h2>6.6 Local Bivariate Join Count<a class="headerlink" href="#local-bivariate-join-count" title="Permalink to this headline">¶</a></h2>
<p>For demonstration of local bivariate or no-colocation join count, we create another binary data
manually:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">top_lit</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mf">54.999999999999986</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">guerry</span><span class="p">[</span><span class="s1">&#39;Litercy&#39;</span><span class="p">]]</span>
</pre></div>
</div>
<p>With no-colocation, two binary events can not be 1 at the same location.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">top_lit</span>
<span class="go">[0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">top_crmprp</span>
<span class="go">[1, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 1, 1, 0, 1, 1, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In case of co-location, a warning message will be raised “The bivariate local join count only applies on two variables with no-colocation.”
, and one can use pygeoda.local_multijoincount() for co-location case.</p>
</div>
<p>Then, we can apply the function <cite>local_bijoincount()</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lbjc_topcrm_lit</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">local_bijoincount</span><span class="p">(</span><span class="n">queen_w</span><span class="p">,</span> <span class="p">[</span><span class="n">topcrm</span><span class="p">,</span> <span class="n">toplit</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lbjc_topcrm_lit</span>
<span class="go">lisa object:</span>
<span class="go">    lisa_values(): [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...]</span>
<span class="go">    lisa_pvalues(): [0.397, nan, nan, nan, nan, nan, nan, nan, nan, nan, ...]</span>
<span class="go">    lisa_num_nbrs(): [4, 6, 6, 4, 3, 7, 3, 3, 5, 5, ...]</span>
<span class="go">    lisa_clusters(): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...]</span>
<span class="go">    lisa_labels(): (&#39;Not significant&#39;, &#39;Significant&#39;, &#39;Undefined&#39;, &#39;Isolated&#39;)</span>
<span class="go">    lisa_colors(): (&#39;#eeeeee&#39;, &#39;#348124&#39;, &#39;#464646&#39;, &#39;#999999&#39;)</span>
</pre></div>
</div>
</div>
<div class="section" id="local-multivariate-join-count">
<h2>6.7 Local Multivariate Join Count<a class="headerlink" href="#local-multivariate-join-count" title="Permalink to this headline">¶</a></h2>
<p>With co-location, both binary events have to be 1 at the same location more than once.
For demonstration, we create the third binary data manually, and using the 3 binary data
together for the case of co-location:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">top_infant</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mf">10712.499999999996</span> <span class="k">else</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">guerry</span><span class="p">[</span><span class="s1">&#39;Donatns&#39;</span><span class="p">]]</span>
<span class="go">[0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 1, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lmjc</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">local_multijoincount</span><span class="p">(</span><span class="n">queen_w</span><span class="p">,</span> <span class="p">[</span><span class="n">topcrm</span><span class="p">,</span> <span class="n">toplit</span><span class="p">,</span> <span class="n">topdon</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="section" id="quantile-lisa">
<h2>6.8 Quantile LISA<a class="headerlink" href="#quantile-lisa" title="Permalink to this headline">¶</a></h2>
<p>The quantile local spatial autocorrelation converte the continuous variable
to a binary variable that takes the value of 1 for a specific quantile.
Then appaly a local join count to the data converted. Two input parameters, k and q,
need to be specified in the function <cite>pygeoda.quantile_lisa()</cite>: k is the number of quantiles
(k &gt; 2), and the q is the index of selected quantile lisa
ranging from 1 to k.</p>
<p>For example, the examples in section 6.5 can be simply implemented as</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ql</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">quantile_lisa</span><span class="p">(</span><span class="n">queen_w</span><span class="p">,</span> <span class="n">crm_prp</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="go">lisa object:</span>
<span class="go">    lisa_values(): [1.0, 0.0, 0.0, 0.0, 0.0, 2.0, 0.0, 1.0, 0.0, 2.0, ...]</span>
<span class="go">    lisa_pvalues(): [0.419, nan, nan, nan, nan, 0.376, nan, 0.442, nan, 0.257, ...]</span>
<span class="go">    lisa_num_nbrs(): [4, 6, 6, 4, 3, 7, 3, 3, 5, 5, ...]</span>
<span class="go">    lisa_clusters(): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...]</span>
<span class="go">    lisa_labels(): (&#39;Not significant&#39;, &#39;Significant&#39;, &#39;Undefined&#39;, &#39;Isolated&#39;)</span>
<span class="go">    lisa_colors(): (&#39;#eeeeee&#39;, &#39;#348124&#39;, &#39;#464646&#39;, &#39;#999999&#39;)</span>
</pre></div>
</div>
</div>
<div class="section" id="multivariate-quantile-lisa">
<h2>6.9 Multivariate Quantile LISA<a class="headerlink" href="#multivariate-quantile-lisa" title="Permalink to this headline">¶</a></h2>
<p>For multiple variables, the Quantile LISA can automatiaclly detect if it is the case of
no-colocation, in which local_bijoincount() will be called internally, or the case of
co-location, in which local_multijoincount() will be called internally.</p>
<p>For exmaple, the example in section 6.6 can be implemented using multivariate quantile lisa:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bql</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">local_multiquantilelisa</span><span class="p">(</span><span class="n">queen_w</span><span class="p">,</span> <span class="p">[</span><span class="n">crm_prp</span><span class="p">,</span> <span class="n">guerry</span><span class="p">[</span><span class="s1">&#39;Litercy&#39;</span><span class="p">]],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bql</span>
<span class="go">lisa object:</span>
<span class="go">    lisa_values(): [1.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, ...]</span>
<span class="go">    lisa_pvalues(): [0.397, nan, nan, nan, nan, nan, nan, nan, nan, nan, ...]</span>
<span class="go">    lisa_num_nbrs(): [4, 6, 6, 4, 3, 7, 3, 3, 5, 5, ...]</span>
<span class="go">    lisa_clusters(): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...]</span>
<span class="go">    lisa_labels(): (&#39;Not significant&#39;, &#39;Significant&#39;, &#39;Undefined&#39;, &#39;Isolated&#39;)</span>
<span class="go">    lisa_colors(): (&#39;#eeeeee&#39;, &#39;#348124&#39;, &#39;#464646&#39;, &#39;#999999&#39;)</span>
</pre></div>
</div>
</div>
<div class="section" id="neighbor-match-test">
<h2>6.10 Neighbor Match Test<a class="headerlink" href="#neighbor-match-test" title="Permalink to this headline">¶</a></h2>
<p>The local neighbor match test is to assess the extent of overlap between
k-nearest neighbors in geographical space and k-nearest neighbors in
multi-attribute space.</p>
<p>For example, to apply the Neighbor Match Test on 6 variables:
‘Crm_prs’,’Crm_prp’,’Litercy’,’Donatns’,’Infants’,’Suicids’ in multi-attribute space
and k=6 nearest neighbors in geographical space:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">guerry</span><span class="p">[[</span><span class="s1">&#39;Crm_prs&#39;</span><span class="p">,</span><span class="s1">&#39;Crm_prp&#39;</span><span class="p">,</span><span class="s1">&#39;Litercy&#39;</span><span class="p">,</span><span class="s1">&#39;Donatns&#39;</span><span class="p">,</span><span class="s1">&#39;Infants&#39;</span><span class="p">,</span><span class="s1">&#39;Suicids&#39;</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nm</span> <span class="o">=</span> <span class="n">pygeoda</span><span class="o">.</span><span class="n">neighbor_match_test</span><span class="p">(</span><span class="n">guerry</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nm</span>
<span class="go">{&#39;Cardinality&#39;: [2, 3,  ...],</span>
<span class="go"> &#39;Probability&#39;: [0.05263799873777295, 0.0037431465769082986, ...]</span>
<span class="go">}</span>
</pre></div>
</div>
<p><cite>pygeoda.neighbor_match_test()</cite> function returns a dict which has two keys “Cardinality” and “Probability”.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="spatial_clustering.html" class="btn btn-neutral float-right" title="6 Spatial Clustering" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="spatial_weights.html" class="btn btn-neutral float-left" title="5 Spatial Weights" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Xun Li; Luc Anselin.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-182260526-2', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>